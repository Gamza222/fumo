7e008736412eaf25089b9dc53824e237
"use strict";
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (this && this.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === "function" ? Iterator : Object).prototype);
    return g.next = verb(0), g["throw"] = verb(1), g["return"] = verb(2), typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};
var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {
    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
        if (ar || !(i in from)) {
            if (!ar) ar = Array.prototype.slice.call(from, 0, i);
            ar[i] = from[i];
        }
    }
    return to.concat(ar || Array.prototype.slice.call(from));
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var jsx_runtime_1 = require("react/jsx-runtime");
// ============================================================================
// TEST SETUP
// ============================================================================
// Mock the classNames utility
jest.mock("@/shared/lib/utils/classNames", function () { return ({
    classNames: function (base, mods, classes) {
        return __spreadArray([base], classes, true).filter(Boolean).join(" ");
    },
}); });
/**
 * InitialLoader Component Tests
 */
var react_1 = __importDefault(require("react"));
var react_2 = require("@testing-library/react");
var InitialLoader_1 = require("./InitialLoader");
var app_loading_1 = require("@/infrastructure/providers/app-loading");
// ============================================================================
// TEST UTILITIES
// ============================================================================
var renderWithProvider = function (props) {
    if (props === void 0) { props = {}; }
    return (0, react_2.render)((0, jsx_runtime_1.jsx)(app_loading_1.AppLoadingProvider, { children: (0, jsx_runtime_1.jsx)(InitialLoader_1.InitialLoader, __assign({}, props)) }));
};
// ============================================================================
// TESTS
// ============================================================================
describe("InitialLoader", function () {
    describe("Basic Rendering", function () {
        it("should render with default props", function () { return __awaiter(void 0, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        renderWithProvider();
                        // Check for progress bar role
                        expect(react_2.screen.getByRole("progressbar")).toBeInTheDocument();
                        // Check for loading message
                        return [4 /*yield*/, (0, react_2.waitFor)(function () {
                                expect(react_2.screen.getByText(/Loading/i)).toBeInTheDocument();
                            })];
                    case 1:
                        // Check for loading message
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        }); });
        it("should render with custom className", function () {
            var container = renderWithProvider({ className: "custom-loader" }).container;
            var loader = container.firstChild;
            expect(loader).toHaveClass("custom-loader");
        });
        it("should have correct ARIA attributes", function () {
            renderWithProvider();
            var progressBar = react_2.screen.getByRole("progressbar");
            expect(progressBar).toHaveAttribute("aria-label", "Loading application");
            expect(progressBar).toHaveAttribute("aria-valuemin", "0");
            expect(progressBar).toHaveAttribute("aria-valuemax", "100");
        });
    });
    describe("Progress Display", function () {
        it("should show progress percentage", function () { return __awaiter(void 0, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        renderWithProvider();
                        // Wait for progress to be displayed
                        return [4 /*yield*/, (0, react_2.waitFor)(function () {
                                expect(react_2.screen.getByText(/\d+%/)).toBeInTheDocument();
                            })];
                    case 1:
                        // Wait for progress to be displayed
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        }); });
        it("should show progress bar with correct width", function () { return __awaiter(void 0, void 0, void 0, function () {
            var container;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        container = renderWithProvider().container;
                        // Wait for progress bar to render
                        return [4 /*yield*/, (0, react_2.waitFor)(function () {
                                var progressBar = container.querySelector('div[style*="width:"]');
                                expect(progressBar).toBeInTheDocument();
                            })];
                    case 1:
                        // Wait for progress bar to render
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        }); });
        it("should hide percentage when showProgress is false", function () {
            renderWithProvider({ showProgress: false });
            // Should not show percentage text
            expect(react_2.screen.queryByText(/\d+%/)).not.toBeInTheDocument();
        });
    });
    describe("Message Display", function () {
        it("should show default loading message", function () { return __awaiter(void 0, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        renderWithProvider();
                        return [4 /*yield*/, (0, react_2.waitFor)(function () {
                                expect(react_2.screen.getByText(/Loading/i)).toBeInTheDocument();
                            })];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        }); });
        it("should show custom message when provided", function () {
            renderWithProvider({ loadingMessage: "Custom loading message" });
            expect(react_2.screen.getByText("Custom loading message")).toBeInTheDocument();
        });
        it("should show step details when enabled", function () { return __awaiter(void 0, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        renderWithProvider({ showStepDetails: true });
                        // Should show some step information
                        return [4 /*yield*/, (0, react_2.waitFor)(function () {
                                var stepElement = react_2.screen.queryByText(/Loading|Ready|Complete/i);
                                expect(stepElement).toBeInTheDocument();
                            })];
                    case 1:
                        // Should show some step information
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        }); });
    });
    describe("Loading States", function () {
        it("should start with loading state", function () {
            renderWithProvider();
            expect(react_2.screen.getByRole("progressbar")).toBeInTheDocument();
            expect(react_2.screen.getByText(/Loading/i)).toBeInTheDocument();
        });
        it("should eventually complete loading", function () { return __awaiter(void 0, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        renderWithProvider();
                        // Wait for loading to complete
                        return [4 /*yield*/, (0, react_2.waitFor)(function () {
                                expect(react_2.screen.getByText("100%")).toBeInTheDocument();
                            }, { timeout: 5000 })];
                    case 1:
                        // Wait for loading to complete
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        }); });
        it("should show ready state when complete", function () { return __awaiter(void 0, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        renderWithProvider();
                        // Wait for completion
                        return [4 /*yield*/, (0, react_2.waitFor)(function () {
                                expect(react_2.screen.getByText("100%")).toBeInTheDocument();
                            }, { timeout: 5000 })];
                    case 1:
                        // Wait for completion
                        _a.sent();
                        // Should show ready message
                        expect(react_2.screen.getByText("Ready!")).toBeInTheDocument();
                        return [2 /*return*/];
                }
            });
        }); });
    });
    describe("Animation States", function () {
        it("should handle fade out animation", function () { return __awaiter(void 0, void 0, void 0, function () {
            var container, loader;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        container = renderWithProvider().container;
                        // Wait for completion
                        return [4 /*yield*/, (0, react_2.waitFor)(function () {
                                expect(react_2.screen.getByText("100%")).toBeInTheDocument();
                            }, { timeout: 5000 })];
                    case 1:
                        // Wait for completion
                        _a.sent();
                        loader = container.firstChild;
                        expect(loader).toHaveClass("fadeOut");
                        return [2 /*return*/];
                }
            });
        }); });
        it("should hide after fade out completes", function () { return __awaiter(void 0, void 0, void 0, function () {
            var container;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        container = renderWithProvider().container;
                        // Wait for completion and fade out
                        return [4 /*yield*/, (0, react_2.waitFor)(function () {
                                expect(react_2.screen.queryByRole("progressbar")).not.toBeInTheDocument();
                            }, { timeout: 6000 })];
                    case 1:
                        // Wait for completion and fade out
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        }); });
    });
    describe("Component Integration", function () {
        it("should integrate with ProgressBar component", function () { return __awaiter(void 0, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        renderWithProvider();
                        // Should have progress bar
                        expect(react_2.screen.getByRole("progressbar")).toBeInTheDocument();
                        // Should show progress
                        return [4 /*yield*/, (0, react_2.waitFor)(function () {
                                expect(react_2.screen.getByText(/\d+%/)).toBeInTheDocument();
                            })];
                    case 1:
                        // Should show progress
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        }); });
        it("should work with all props provided", function () { return __awaiter(void 0, void 0, void 0, function () {
            var container, loader;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        renderWithProvider({
                            showProgress: true,
                            showStepDetails: true,
                            loadingMessage: "Custom message",
                            className: "test-class",
                        });
                        // Check custom message
                        expect(react_2.screen.getByText("Custom message")).toBeInTheDocument();
                        // Check progress
                        return [4 /*yield*/, (0, react_2.waitFor)(function () {
                                expect(react_2.screen.getByText(/\d+%/)).toBeInTheDocument();
                            })];
                    case 1:
                        // Check progress
                        _a.sent();
                        container = renderWithProvider({ className: "test-class" }).container;
                        loader = container.firstChild;
                        expect(loader).toHaveClass("test-class");
                        return [2 /*return*/];
                }
            });
        }); });
    });
    describe("Error Handling", function () {
        it("should handle missing context gracefully", function () {
            // Render without provider to test error boundary
            expect(function () {
                (0, react_2.render)((0, jsx_runtime_1.jsx)(InitialLoader_1.InitialLoader, {}));
            }).toThrow("useAppLoadingContext must be used within an AppLoadingProvider");
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2dhbXphcmFtYXphbm92L0Rlc2t0b3AvZnVtby9zcmMvd2lkZ2V0cy9Jbml0aWFsTG9hZGVyL3VpL0luaXRpYWxMb2FkZXIudGVzdC50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFTQSwrRUFBK0U7QUFDL0UsYUFBYTtBQUNiLCtFQUErRTtBQUUvRSw4QkFBOEI7QUFDOUIsSUFBSSxDQUFDLElBQUksQ0FBQywrQkFBK0IsRUFBRSxjQUFNLE9BQUEsQ0FBQztJQUNoRCxVQUFVLEVBQUUsVUFBQyxJQUFZLEVBQUUsSUFBWSxFQUFFLE9BQWlCO1FBQ3hELE9BQU8sZUFBQyxJQUFJLEdBQUssT0FBTyxRQUFFLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDdEQsQ0FBQztDQUNGLENBQUMsRUFKK0MsQ0FJL0MsQ0FBQyxDQUFDO0FBbEJKOztHQUVHO0FBRUgsZ0RBQTBCO0FBQzFCLGdEQUFpRTtBQUNqRSxpREFBZ0Q7QUFDaEQsc0VBQTRFO0FBYTVFLCtFQUErRTtBQUMvRSxpQkFBaUI7QUFDakIsK0VBQStFO0FBRS9FLElBQU0sa0JBQWtCLEdBQUcsVUFBQyxLQUFVO0lBQVYsc0JBQUEsRUFBQSxVQUFVO0lBQ3BDLE9BQU8sSUFBQSxjQUFNLEVBQ1gsdUJBQUMsZ0NBQWtCLGNBQ2pCLHVCQUFDLDZCQUFhLGVBQUssS0FBSyxFQUFJLEdBQ1QsQ0FDdEIsQ0FBQztBQUNKLENBQUMsQ0FBQztBQUVGLCtFQUErRTtBQUMvRSxRQUFRO0FBQ1IsK0VBQStFO0FBRS9FLFFBQVEsQ0FBQyxlQUFlLEVBQUU7SUFDeEIsUUFBUSxDQUFDLGlCQUFpQixFQUFFO1FBQzFCLEVBQUUsQ0FBQyxrQ0FBa0MsRUFBRTs7Ozt3QkFDckMsa0JBQWtCLEVBQUUsQ0FBQzt3QkFFckIsOEJBQThCO3dCQUM5QixNQUFNLENBQUMsY0FBTSxDQUFDLFNBQVMsQ0FB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LGdCQUFnQixDQUFDLENBQUMsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO3dCQUUvRCxpQkFBaUI7d0JBQ2pCLHFCQUFNLElBQUEsZUFBTyxFQUFDO2dDQUNaLE1BQU0sQ0FBQyxjQUFNLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsaUJBQWlCLEVBQUUsQ0FBQzs0QkFDdkQsQ0FBQyxDQUFDLEVBQUE7O3dCQUhGLGlCQUFpQjt3QkFDakIsU0FFRSxDQUFDO3dCQUdLLFNBQVMsR0FBSyxrQkFBa0IsQ0FBQyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsQ0FBQyxVQUFwRCxDQUFxRDt3QkFDaEUsTUFBTSxHQUFHLFNBQVMsQ0FBQyxVQUF5QixDQUFDO3dCQUNuRCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxDQUFDOzs7O2FBQzFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGdCQUFnQixFQUFFO1FBQ3pCLEVBQUUsQ0FBQywwQ0FBMEMsRUFBRTtZQUM3QyxpREFBaUQ7WUFDakQsTUFBTSxDQUFDO2dCQUNMLElBQUEsY0FBTSxFQUFDLHVCQUFDLDZCQUFhLEtBQUcsQ0FBQyxDQUFDO1lBQzVCLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FDUixnRUFBZ0UsQ0FDakUsQ0FBQztRQUNKLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvZ2FtemFyYW1hemFub3YvRGVza3RvcC9mdW1vL3NyYy93aWRnZXRzL0luaXRpYWxMb2FkZXIvdWkvSW5pdGlhbExvYWRlci50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEluaXRpYWxMb2FkZXIgQ29tcG9uZW50IFRlc3RzXG4gKi9cblxuaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgcmVuZGVyLCBzY3JlZW4sIHdhaXRGb3IgfSBmcm9tIFwiQHRlc3RpbmctbGlicmFyeS9yZWFjdFwiO1xuaW1wb3J0IHsgSW5pdGlhbExvYWRlciB9IGZyb20gXCIuL0luaXRpYWxMb2FkZXJcIjtcbmltcG9ydCB7IEFwcExvYWRpbmdQcm92aWRlciB9IGZyb20gXCJAL2luZnJhc3RydWN0dXJlL3Byb3ZpZGVycy9hcHAtbG9hZGluZ1wiO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBURVNUIFNFVFVQXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8vIE1vY2sgdGhlIGNsYXNzTmFtZXMgdXRpbGl0eVxuamVzdC5tb2NrKFwiQC9zaGFyZWQvbGliL3V0aWxzL2NsYXNzTmFtZXNcIiwgKCkgPT4gKHtcbiAgY2xhc3NOYW1lczogKGJhc2U6IHN0cmluZywgbW9kczogb2JqZWN0LCBjbGFzc2VzOiBzdHJpbmdbXSkgPT4ge1xuICAgIHJldHVybiBbYmFzZSwgLi4uY2xhc3Nlc10uZmlsdGVyKEJvb2xlYW4pLmpvaW4oXCIgXCIpO1xuICB9LFxufSkpO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBURVNUIFVUSUxJVElFU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5jb25zdCByZW5kZXJXaXRoUHJvdmlkZXIgPSAocHJvcHMgPSB7fSkgPT4ge1xuICByZXR1cm4gcmVuZGVyKFxuICAgIDxBcHBMb2FkaW5nUHJvdmlkZXI+XG4gICAgICA8SW5pdGlhbExvYWRlciB7Li4ucHJvcHN9IC8+XG4gICAgPC9BcHBMb2FkaW5nUHJvdmlkZXI+XG4gICk7XG59O1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBURVNUU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5kZXNjcmliZShcIkluaXRpYWxMb2FkZXJcIiwgKCkgPT4ge1xuICBkZXNjcmliZShcIkJhc2ljIFJlbmRlcmluZ1wiLCAoKSA9PiB7XG4gICAgaXQoXCJzaG91bGQgcmVuZGVyIHdpdGggZGVmYXVsdCBwcm9wc1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXJXaXRoUHJvdmlkZXIoKTtcblxuICAgICAgLy8gQ2hlY2sgZm9yIHByb2dyZXNzIGJhciByb2xlXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5Um9sZShcInByb2dyZXNzYmFyXCIpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuXG4gICAgICAvLyBDaGVjayBmb3IgbG9hZGluZyBtZXNzYWdlXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoL0xvYWRpbmcvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIHJlbmRlciB3aXRoIGN1c3RvbSBjbGFzc05hbWVcIiwgKCkgPT4ge1xuICAgICAgY29uc3QgeyBjb250YWluZXIgfSA9IHJlbmRlcldpdGhQcm92aWRlcih7IGNsYXNzTmFtZTogXCJjdXN0b20tbG9hZGVyXCIgfSk7XG5cbiAgICAgIGNvbnN0IGxvYWRlciA9IGNvbnRhaW5lci5maXJzdENoaWxkIGFzIEhUTUxFbGVtZW50O1xuICAgICAgZXhwZWN0KGxvYWRlcikudG9IYXZlQ2xhc3MoXCJjdXN0b20tbG9hZGVyXCIpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgaGF2ZSBjb3JyZWN0IEFSSUEgYXR0cmlidXRlc1wiLCAoKSA9PiB7XG4gICAgICByZW5kZXJXaXRoUHJvdmlkZXIoKTtcblxuICAgICAgY29uc3QgcHJvZ3Jlc3NCYXIgPSBzY3JlZW4uZ2V0QnlSb2xlKFwicHJvZ3Jlc3NiYXJcIik7XG4gICAgICBleHBlY3QocHJvZ3Jlc3NCYXIpLnRvSGF2ZUF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgXCJMb2FkaW5nIGFwcGxpY2F0aW9uXCIpO1xuICAgICAgZXhwZWN0KHByb2dyZXNzQmFyKS50b0hhdmVBdHRyaWJ1dGUoXCJhcmlhLXZhbHVlbWluXCIsIFwiMFwiKTtcbiAgICAgIGV4cGVjdChwcm9ncmVzc0JhcikudG9IYXZlQXR0cmlidXRlKFwiYXJpYS12YWx1ZW1heFwiLCBcIjEwMFwiKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJQcm9ncmVzcyBEaXNwbGF5XCIsICgpID0+IHtcbiAgICBpdChcInNob3VsZCBzaG93IHByb2dyZXNzIHBlcmNlbnRhZ2VcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyV2l0aFByb3ZpZGVyKCk7XG5cbiAgICAgIC8vIFdhaXQgZm9yIHByb2dyZXNzIHRvIGJlIGRpc3BsYXllZFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9cXGQrJS8pKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBzaG93IHByb2dyZXNzIGJhciB3aXRoIGNvcnJlY3Qgd2lkdGhcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgeyBjb250YWluZXIgfSA9IHJlbmRlcldpdGhQcm92aWRlcigpO1xuXG4gICAgICAvLyBXYWl0IGZvciBwcm9ncmVzcyBiYXIgdG8gcmVuZGVyXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3QgcHJvZ3Jlc3NCYXIgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignZGl2W3N0eWxlKj1cIndpZHRoOlwiXScpO1xuICAgICAgICBleHBlY3QocHJvZ3Jlc3NCYXIpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIGhpZGUgcGVyY2VudGFnZSB3aGVuIHNob3dQcm9ncmVzcyBpcyBmYWxzZVwiLCAoKSA9PiB7XG4gICAgICByZW5kZXJXaXRoUHJvdmlkZXIoeyBzaG93UHJvZ3Jlc3M6IGZhbHNlIH0pO1xuXG4gICAgICAvLyBTaG91bGQgbm90IHNob3cgcGVyY2VudGFnZSB0ZXh0XG4gICAgICBleHBlY3Qoc2NyZWVuLnF1ZXJ5QnlUZXh0KC9cXGQrJS8pKS5ub3QudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJNZXNzYWdlIERpc3BsYXlcIiwgKCkgPT4ge1xuICAgIGl0KFwic2hvdWxkIHNob3cgZGVmYXVsdCBsb2FkaW5nIG1lc3NhZ2VcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyV2l0aFByb3ZpZGVyKCk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgvTG9hZGluZy9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgc2hvdyBjdXN0b20gbWVzc2FnZSB3aGVuIHByb3ZpZGVkXCIsICgpID0+IHtcbiAgICAgIHJlbmRlcldpdGhQcm92aWRlcih7IGxvYWRpbmdNZXNzYWdlOiBcIkN1c3RvbSBsb2FkaW5nIG1lc3NhZ2VcIiB9KTtcblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoXCJDdXN0b20gbG9hZGluZyBtZXNzYWdlXCIpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG91bGQgc2hvdyBzdGVwIGRldGFpbHMgd2hlbiBlbmFibGVkXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcldpdGhQcm92aWRlcih7IHNob3dTdGVwRGV0YWlsczogdHJ1ZSB9KTtcblxuICAgICAgLy8gU2hvdWxkIHNob3cgc29tZSBzdGVwIGluZm9ybWF0aW9uXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3Qgc3RlcEVsZW1lbnQgPSBzY3JlZW4ucXVlcnlCeVRleHQoL0xvYWRpbmd8UmVhZHl8Q29tcGxldGUvaSk7XG4gICAgICAgIGV4cGVjdChzdGVwRWxlbWVudCkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZShcIkxvYWRpbmcgU3RhdGVzXCIsICgpID0+IHtcbiAgICBpdChcInNob3VsZCBzdGFydCB3aXRoIGxvYWRpbmcgc3RhdGVcIiwgKCkgPT4ge1xuICAgICAgcmVuZGVyV2l0aFByb3ZpZGVyKCk7XG5cbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlSb2xlKFwicHJvZ3Jlc3NiYXJcIikpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgvTG9hZGluZy9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIGV2ZW50dWFsbHkgY29tcGxldGUgbG9hZGluZ1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXJXaXRoUHJvdmlkZXIoKTtcblxuICAgICAgLy8gV2FpdCBmb3IgbG9hZGluZyB0byBjb21wbGV0ZVxuICAgICAgYXdhaXQgd2FpdEZvcihcbiAgICAgICAgKCkgPT4ge1xuICAgICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KFwiMTAwJVwiKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgICAgfSxcbiAgICAgICAgeyB0aW1lb3V0OiA1MDAwIH1cbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCBzaG93IHJlYWR5IHN0YXRlIHdoZW4gY29tcGxldGVcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgcmVuZGVyV2l0aFByb3ZpZGVyKCk7XG5cbiAgICAgIC8vIFdhaXQgZm9yIGNvbXBsZXRpb25cbiAgICAgIGF3YWl0IHdhaXRGb3IoXG4gICAgICAgICgpID0+IHtcbiAgICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dChcIjEwMCVcIikpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICAgIH0sXG4gICAgICAgIHsgdGltZW91dDogNTAwMCB9XG4gICAgICApO1xuXG4gICAgICAvLyBTaG91bGQgc2hvdyByZWFkeSBtZXNzYWdlXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dChcIlJlYWR5IVwiKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJBbmltYXRpb24gU3RhdGVzXCIsICgpID0+IHtcbiAgICBpdChcInNob3VsZCBoYW5kbGUgZmFkZSBvdXQgYW5pbWF0aW9uXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHsgY29udGFpbmVyIH0gPSByZW5kZXJXaXRoUHJvdmlkZXIoKTtcblxuICAgICAgLy8gV2FpdCBmb3IgY29tcGxldGlvblxuICAgICAgYXdhaXQgd2FpdEZvcihcbiAgICAgICAgKCkgPT4ge1xuICAgICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KFwiMTAwJVwiKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgICAgfSxcbiAgICAgICAgeyB0aW1lb3V0OiA1MDAwIH1cbiAgICAgICk7XG5cbiAgICAgIC8vIFNob3VsZCBoYXZlIGZhZGUgb3V0IGNsYXNzXG4gICAgICBjb25zdCBsb2FkZXIgPSBjb250YWluZXIuZmlyc3RDaGlsZCBhcyBIVE1MRWxlbWVudDtcbiAgICAgIGV4cGVjdChsb2FkZXIpLnRvSGF2ZUNsYXNzKFwiZmFkZU91dFwiKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvdWxkIGhpZGUgYWZ0ZXIgZmFkZSBvdXQgY29tcGxldGVzXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHsgY29udGFpbmVyIH0gPSByZW5kZXJXaXRoUHJvdmlkZXIoKTtcblxuICAgICAgLy8gV2FpdCBmb3IgY29tcGxldGlvbiBhbmQgZmFkZSBvdXRcbiAgICAgIGF3YWl0IHdhaXRGb3IoXG4gICAgICAgICgpID0+IHtcbiAgICAgICAgICBleHBlY3Qoc2NyZWVuLnF1ZXJ5QnlSb2xlKFwicHJvZ3Jlc3NiYXJcIikpLm5vdC50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgICB9LFxuICAgICAgICB7IHRpbWVvdXQ6IDYwMDAgfVxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJDb21wb25lbnQgSW50ZWdyYXRpb25cIiwgKCkgPT4ge1xuICAgIGl0KFwic2hvdWxkIGludGVncmF0ZSB3aXRoIFByb2dyZXNzQmFyIGNvbXBvbmVudFwiLCBhc3luYyAoKSA9PiB7XG4gICAgICByZW5kZXJXaXRoUHJvdmlkZXIoKTtcblxuICAgICAgLy8gU2hvdWxkIGhhdmUgcHJvZ3Jlc3MgYmFyXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5Um9sZShcInByb2dyZXNzYmFyXCIpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuXG4gICAgICAvLyBTaG91bGQgc2hvdyBwcm9ncmVzc1xuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9cXGQrJS8pKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3VsZCB3b3JrIHdpdGggYWxsIHByb3BzIHByb3ZpZGVkXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIHJlbmRlcldpdGhQcm92aWRlcih7XG4gICAgICAgIHNob3dQcm9ncmVzczogdHJ1ZSxcbiAgICAgICAgc2hvd1N0ZXBEZXRhaWxzOiB0cnVlLFxuICAgICAgICBsb2FkaW5nTWVzc2FnZTogXCJDdXN0b20gbWVzc2FnZVwiLFxuICAgICAgICBjbGFzc05hbWU6IFwidGVzdC1jbGFzc1wiLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIENoZWNrIGN1c3RvbSBtZXNzYWdlXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dChcIkN1c3RvbSBtZXNzYWdlXCIpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuXG4gICAgICAvLyBDaGVjayBwcm9ncmVzc1xuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9cXGQrJS8pKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENoZWNrIGNsYXNzTmFtZVxuICAgICAgY29uc3QgeyBjb250YWluZXIgfSA9IHJlbmRlcldpdGhQcm92aWRlcih7IGNsYXNzTmFtZTogXCJ0ZXN0LWNsYXNzXCIgfSk7XG4gICAgICBjb25zdCBsb2FkZXIgPSBjb250YWluZXIuZmlyc3RDaGlsZCBhcyBIVE1MRWxlbWVudDtcbiAgICAgIGV4cGVjdChsb2FkZXIpLnRvSGF2ZUNsYXNzKFwidGVzdC1jbGFzc1wiKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJFcnJvciBIYW5kbGluZ1wiLCAoKSA9PiB7XG4gICAgaXQoXCJzaG91bGQgaGFuZGxlIG1pc3NpbmcgY29udGV4dCBncmFjZWZ1bGx5XCIsICgpID0+IHtcbiAgICAgIC8vIFJlbmRlciB3aXRob3V0IHByb3ZpZGVyIHRvIHRlc3QgZXJyb3IgYm91bmRhcnlcbiAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgIHJlbmRlcig8SW5pdGlhbExvYWRlciAvPik7XG4gICAgICB9KS50b1Rocm93KFxuICAgICAgICBcInVzZUFwcExvYWRpbmdDb250ZXh0IG11c3QgYmUgdXNlZCB3aXRoaW4gYW4gQXBwTG9hZGluZ1Byb3ZpZGVyXCJcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=