{"file":"/Users/gamzaramazanov/Desktop/fumo/src/infrastructure/performance/lib/http-cache/http-cache.ts","mappings":"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","names":[],"sources":["/Users/gamzaramazanov/Desktop/fumo/src/infrastructure/performance/lib/http-cache/http-cache.ts"],"sourcesContent":["/**\n * HTTP Caching Utilities\n *\n * HTTP caching strategies and configuration for maximum performance.\n * Built on top of existing performance monitoring infrastructure.\n */\n\nimport type {\n  CacheStrategyConfig,\n  HTTPCacheConfig,\n  PerformanceMetric,\n} from '../../types/performance.types';\nimport { PerformanceRating } from '../../types/performance.enums';\nimport { performanceMonitor } from '../performance-monitor';\n\n// ============================================================================\n// DEFAULT CONFIGURATIONS\n// ============================================================================\n\n// const _DEFAULT_CACHE_CONFIG: HTTPCacheConfig = {\n//   maxAge: 31536000, // 1 year\n//   sMaxAge: 31536000, // 1 year\n//   etag: true,\n//   lastModified: true,\n//   directives: ['public'],\n// };\n\nconst CACHE_STRATEGIES: Record<string, CacheStrategyConfig> = {\n  static: {\n    type: 'static',\n    config: {\n      maxAge: 31536000, // 1 year\n      sMaxAge: 31536000, // 1 year\n      etag: true,\n      lastModified: true,\n      directives: ['public', 'immutable'],\n    },\n    keyPattern: 'static-*',\n  },\n  dynamic: {\n    type: 'dynamic',\n    config: {\n      maxAge: 3600, // 1 hour\n      sMaxAge: 86400, // 1 day\n      etag: true,\n      lastModified: true,\n      directives: ['public'],\n    },\n    keyPattern: 'dynamic-*',\n  },\n  api: {\n    type: 'api',\n    config: {\n      maxAge: 300, // 5 minutes\n      sMaxAge: 3600, // 1 hour\n      etag: true,\n      lastModified: false,\n      directives: ['public'],\n    },\n    keyPattern: 'api-*',\n  },\n  image: {\n    type: 'image',\n    config: {\n      maxAge: 2592000, // 30 days\n      sMaxAge: 31536000, // 1 year\n      etag: true,\n      lastModified: true,\n      directives: ['public', 'immutable'],\n    },\n    keyPattern: 'image-*',\n  },\n  font: {\n    type: 'font',\n    config: {\n      maxAge: 31536000, // 1 year\n      sMaxAge: 31536000, // 1 year\n      etag: true,\n      lastModified: true,\n      directives: ['public', 'immutable'],\n    },\n    keyPattern: 'font-*',\n  },\n};\n\n// ============================================================================\n// HTTP CACHING UTILITIES\n// ============================================================================\n\n/**\n * Generate Cache-Control header\n */\nexport function generateCacheControlHeader(config: HTTPCacheConfig): string {\n  const startTime = performance.now();\n\n  try {\n    const directives: string[] = [];\n\n    // Add max-age\n    if (config.maxAge) {\n      directives.push(`max-age=${config.maxAge}`);\n    }\n\n    // Add s-maxage\n    if (config.sMaxAge) {\n      directives.push(`s-maxage=${config.sMaxAge}`);\n    }\n\n    // Add custom directives\n    if (config.directives) {\n      directives.push(...config.directives);\n    }\n\n    const cacheControl = directives.join(', ');\n\n    // Track performance metric\n    const endTime = performance.now();\n    performanceMonitor.addMetric({\n      name: 'cache_control_generation',\n      value: endTime - startTime,\n      timestamp: Date.now(),\n      rating:\n        endTime - startTime < 1 ? PerformanceRating.GOOD : PerformanceRating.NEEDS_IMPROVEMENT,\n    });\n\n    return cacheControl;\n  } catch (error) {\n    performanceMonitor.addMetric({\n      name: 'cache_control_generation_error',\n      value: 0,\n      timestamp: Date.now(),\n      rating: PerformanceRating.POOR,\n    });\n\n    return 'no-cache';\n  }\n}\n\n/**\n * Generate ETag header\n */\nexport function generateETagHeader(content: string): string {\n  const startTime = performance.now();\n\n  try {\n    // Simple ETag generation based on content hash\n    let hash = 0;\n    for (let i = 0; i < content.length; i++) {\n      const char = content.charCodeAt(i);\n      hash = (hash << 5) - hash + char;\n      hash = hash & hash; // Convert to 32-bit integer\n    }\n\n    const etag = `\"${Math.abs(hash).toString(16)}\"`;\n\n    // Track performance metric\n    const endTime = performance.now();\n    performanceMonitor.addMetric({\n      name: 'etag_generation',\n      value: endTime - startTime,\n      timestamp: Date.now(),\n      rating:\n        endTime - startTime < 5 ? PerformanceRating.GOOD : PerformanceRating.NEEDS_IMPROVEMENT,\n    });\n\n    return etag;\n  } catch (error) {\n    performanceMonitor.addMetric({\n      name: 'etag_generation_error',\n      value: 0,\n      timestamp: Date.now(),\n      rating: PerformanceRating.POOR,\n    });\n\n    return `\"${Date.now()}\"`;\n  }\n}\n\n/**\n * Generate Last-Modified header\n */\nexport function generateLastModifiedHeader(date: Date = new Date()): string {\n  const startTime = performance.now();\n\n  try {\n    const lastModified = date.toUTCString();\n\n    // Track performance metric\n    const endTime = performance.now();\n    performanceMonitor.addMetric({\n      name: 'last_modified_generation',\n      value: endTime - startTime,\n      timestamp: Date.now(),\n      rating:\n        endTime - startTime < 1 ? PerformanceRating.GOOD : PerformanceRating.NEEDS_IMPROVEMENT,\n    });\n\n    return lastModified;\n  } catch (error) {\n    performanceMonitor.addMetric({\n      name: 'last_modified_generation_error',\n      value: 0,\n      timestamp: Date.now(),\n      rating: PerformanceRating.POOR,\n    });\n\n    return new Date().toUTCString();\n  }\n}\n\n/**\n * Get cache strategy for resource type\n */\nexport function getCacheStrategy(resourceType: string): CacheStrategyConfig {\n  const startTime = performance.now();\n\n  try {\n    const strategy = CACHE_STRATEGIES[resourceType] || CACHE_STRATEGIES.dynamic;\n\n    // Track performance metric\n    const endTime = performance.now();\n    performanceMonitor.addMetric({\n      name: 'cache_strategy_lookup',\n      value: endTime - startTime,\n      timestamp: Date.now(),\n      rating:\n        endTime - startTime < 1 ? PerformanceRating.GOOD : PerformanceRating.NEEDS_IMPROVEMENT,\n    });\n\n    return strategy!;\n  } catch (error) {\n    performanceMonitor.addMetric({\n      name: 'cache_strategy_lookup_error',\n      value: 0,\n      timestamp: Date.now(),\n      rating: PerformanceRating.POOR,\n    });\n\n    return CACHE_STRATEGIES.dynamic!;\n  }\n}\n\n/**\n * Generate cache headers for resource\n */\nexport function generateCacheHeaders(\n  resourceType: string,\n  content: string,\n  lastModified?: Date\n): Record<string, string> {\n  const startTime = performance.now();\n\n  try {\n    const strategy = getCacheStrategy(resourceType);\n    const headers: Record<string, string> = {};\n\n    // Generate Cache-Control header\n    headers['Cache-Control'] = generateCacheControlHeader(strategy.config);\n\n    // Generate ETag header\n    if (strategy.config.etag) {\n      headers['ETag'] = generateETagHeader(content);\n    }\n\n    // Generate Last-Modified header\n    if (strategy.config.lastModified) {\n      headers['Last-Modified'] = generateLastModifiedHeader(lastModified);\n    }\n\n    // Track performance metric\n    const endTime = performance.now();\n    performanceMonitor.addMetric({\n      name: 'cache_headers_generation',\n      value: endTime - startTime,\n      timestamp: Date.now(),\n      rating:\n        endTime - startTime < 10 ? PerformanceRating.GOOD : PerformanceRating.NEEDS_IMPROVEMENT,\n    });\n\n    return headers;\n  } catch (error) {\n    performanceMonitor.addMetric({\n      name: 'cache_headers_generation_error',\n      value: 0,\n      timestamp: Date.now(),\n      rating: PerformanceRating.POOR,\n    });\n\n    return {\n      'Cache-Control': 'no-cache',\n    };\n  }\n}\n\n/**\n * Check if request is cacheable\n */\nexport function isCacheableRequest(method: string, headers: Record<string, string>): boolean {\n  const startTime = performance.now();\n\n  try {\n    // Only GET requests are cacheable\n    if (method !== 'GET') {\n      return false;\n    }\n\n    // Check for cache-busting headers\n    const cacheBustingHeaders = ['cache-control', 'pragma', 'if-none-match', 'if-modified-since'];\n\n    const hasCacheBusting = cacheBustingHeaders.some(\n      (header) => headers[header] && headers[header].includes('no-cache')\n    );\n\n    if (hasCacheBusting) {\n      return false;\n    }\n\n    // Track performance metric\n    const endTime = performance.now();\n    performanceMonitor.addMetric({\n      name: 'cacheability_check',\n      value: endTime - startTime,\n      timestamp: Date.now(),\n      rating:\n        endTime - startTime < 1 ? PerformanceRating.GOOD : PerformanceRating.NEEDS_IMPROVEMENT,\n    });\n\n    return true;\n  } catch (error) {\n    performanceMonitor.addMetric({\n      name: 'cacheability_check_error',\n      value: 0,\n      timestamp: Date.now(),\n      rating: PerformanceRating.POOR,\n    });\n\n    return false;\n  }\n}\n\n/**\n * Generate cache key for resource\n */\nexport function generateCacheKey(\n  resourceType: string,\n  resourcePath: string,\n  queryParams?: Record<string, string>\n): string {\n  const startTime = performance.now();\n\n  try {\n    const strategy = getCacheStrategy(resourceType);\n    const baseKey = strategy.keyPattern?.replace('*', resourcePath) || resourcePath;\n\n    let cacheKey = baseKey;\n\n    // Add query parameters to cache key\n    if (queryParams && Object.keys(queryParams).length > 0) {\n      const sortedParams = Object.keys(queryParams)\n        .sort()\n        .map((key) => `${key}=${queryParams[key]}`)\n        .join('&');\n      cacheKey += `?${sortedParams}`;\n    }\n\n    // Track performance metric\n    const endTime = performance.now();\n    performanceMonitor.addMetric({\n      name: 'cache_key_generation',\n      value: endTime - startTime,\n      timestamp: Date.now(),\n      rating:\n        endTime - startTime < 1 ? PerformanceRating.GOOD : PerformanceRating.NEEDS_IMPROVEMENT,\n    });\n\n    return cacheKey;\n  } catch (error) {\n    performanceMonitor.addMetric({\n      name: 'cache_key_generation_error',\n      value: 0,\n      timestamp: Date.now(),\n      rating: PerformanceRating.POOR,\n    });\n\n    return resourcePath;\n  }\n}\n\n/**\n * Get cache performance metrics\n */\nexport function getCacheMetrics(): PerformanceMetric[] {\n  return performanceMonitor\n    .getMetricsByName('cache_control_generation')\n    .concat(performanceMonitor.getMetricsByName('etag_generation'))\n    .concat(performanceMonitor.getMetricsByName('last_modified_generation'))\n    .concat(performanceMonitor.getMetricsByName('cache_strategy_lookup'))\n    .concat(performanceMonitor.getMetricsByName('cache_headers_generation'))\n    .concat(performanceMonitor.getMetricsByName('cacheability_check'))\n    .concat(performanceMonitor.getMetricsByName('cache_key_generation'));\n}\n"],"version":3}